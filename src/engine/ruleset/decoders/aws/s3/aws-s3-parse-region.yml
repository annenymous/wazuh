---
name: decoder/aws-s3-parse-region/0

metadata:
  description: Decoder for extracting the cloud regiond from Amazon S3
    server access logs
  references:
    - https://docs.aws.amazon.com/AmazonS3/latest/userguide/LogFormat.html
  product.name: Amazon S3 server access

sources:
  - decoder/aws-s3/0

check:
  - wazuh.modules.aws.source: +s_eq/s3_server_access

parse:
  logpar:
    - ~json.aws.host_header: <?~>s3.<cloud.region>.<~>
