---
name: decoder/test/0

metadata:
  description: Parses nginx access logs
  references: "https://docs.nginx.com/nginx/admin-guide/monitoring/logging/"
  product.name: nginx
  product.versions:
    - nginx-1.23.2 #TODO: Check! this is only the latest version

check:
  - event.original: +ef_exists

parse:
  logpar:
    # example.com 10.0.0.2 -
    # example.com 10.0.0.2, 10.0.0.1, 127.0.0.1 -
    - event.original: >-
        <~domain/fqdn> <destination.ip>(?, <~ip2/ip>, <~ip3/ip>) -


normalize:
  - map:
      - succedeed: ok
